webpackJsonp([26],{cGhg:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("BO1k"),o=a.n(i),r=a("mvHQ"),n=a.n(r),l=a("mw3O"),s=a.n(l),d=a("7+uW"),c={name:"group",components:{},data:function(){return{loading:!0,lists:[],tableData:[],currentPageNum:1,currentPageSize:10,totalItemCount:0,searchText:"",createform:{title:""},updateform:{id:0,title:""},rules:{name:[{required:!0,message:"Name cannot be empty",trigger:"blur"}]},createFormVisible:!1,updateFormVisible:!1,relationFormVisible:!1,moduleAssignments:[],initCheckedKeys:[],currentGroupId:0,defaultProps:{children:"children",label:"name"}}},methods:{uuid:function(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var a=e.join("");return a},loadData:function(){var e=this;this.$http({method:"POST",headers:{"Content-Type":"application/json"},url:"/sqlrest/manager/api/v1/group/listAll",data:n()({page:this.currentPageNum,size:this.currentPageSize,searchText:this.searchText})}).then(function(t){0===t.data.code?(e.totalItemCount=t.data.pagination.total,e.tableData=t.data.data):alert("Failed to load data: "+t.data.message)})},handleClose:function(e){},handleDelete:function(e,t){var a=this;this.$confirm("This operation will delete group ID="+t.id+", continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){a.$http.delete("/sqlrest/manager/api/v1/group/delete/"+t.id).then(function(e){0===e.data.code?a.loadData():alert("Failed to delete: "+e.data.message)})})},addGroup:function(){this.createFormVisible=!0,this.createform={}},handleCreate:function(){var e=this;this.$refs.createform.validate(function(t){t?e.$http({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:"/sqlrest/manager/api/v1/group/create",data:s.a.stringify({name:e.createform.name})}).then(function(t){0===t.data.code?(e.createFormVisible=!1,e.$message("Added successfully"),e.createform={},e.loadData()):alert("Failed to add: "+t.data.message)}):alert("Please check input")})},handleRelation:function(e,t){var a=this;this.moduleAssignments=[],this.$http.get("/sqlrest/manager/api/v1/module/moduleTree/"+t.id).then(function(e){if(0===e.data.code){a.initCheckedKeys=[],a.currentGroupId=t.id,a.moduleAssignments=e.data.data;var i=!0,r=!1,n=void 0;try{for(var l,s=o()(a.moduleAssignments);!(i=(l=s.next()).done);i=!0){var c=l.value;if(d.default.set(c,"id",a.uuid()),c.children){var u=!0,m=!1,p=void 0;try{for(var h,f=o()(c.children);!(u=(h=f.next()).done);u=!0){var v=h.value;v.selected&&a.initCheckedKeys.push(v.id)}}catch(e){m=!0,p=e}finally{try{!u&&f.return&&f.return()}finally{if(m)throw p}}}}}catch(e){r=!0,n=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw n}}}}),this.relationFormVisible=!0},handleRelationSave:function(){var e=this,t=this.$refs.relationTree.getCheckedKeys(!0);this.$http({method:"POST",headers:{"Content-Type":"application/json"},url:"/sqlrest/manager/api/v1/assignment/group/"+this.currentGroupId,data:t}).then(function(t){0===t.data.code?(e.relationFormVisible=!1,e.$message("Association information updated successfully.")):alert("Failed to update: "+t.data.message)})},handleUpdate:function(e,t){this.updateform=JSON.parse(n()(t)),this.updateFormVisible=!0},handleSave:function(){var e=this;this.$refs.updateform.validate(function(t){t?e.$http({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},url:"/sqlrest/manager/api/v1/group/update/"+e.updateform.id,data:s.a.stringify({name:e.updateform.name})}).then(function(t){0===t.data.code?(e.updateFormVisible=!1,e.$message("Updated successfully"),e.loadData(),e.updateform={}):alert("Failed to update: "+t.data.message)}):alert("Please check input")})},handleSizeChange:function(e){this.currentPageSize=e,this.loadData()},handleCurrentChange:function(e){this.currentPageNum=e,this.loadData()},searchByKeyword:function(){this.currentPage=1,this.loadData()}},mounted:function(){this.loadData()}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("div",{staticClass:"group-list-top"},[a("div",{staticClass:"left-search-input-group"},[a("div",{staticClass:"left-search-input"},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Please enter name keyword to search",size:"mini",clearable:!0},on:{change:e.searchByKeyword},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1)]),e._v(" "),a("div",{staticClass:"right-add-button-group"},[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-document-add"},on:{click:e.addGroup}},[e._v("Add")])],1)]),e._v(" "),a("el-table",{attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:e.tableData,size:"small",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID","min-width":"5%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Group Name","show-overflow-tooltip":"","min-width":"20%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"Create Time","min-width":"20%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"updateTime",label:"Update Time","show-overflow-tooltip":"","min-width":"20%"}}),e._v(" "),a("el-table-column",{attrs:{label:"Actions","min-width":"35%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-document",round:""},on:{click:function(a){return e.handleRelation(t.$index,t.row)}}},[e._v("Associate")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-edit",round:""},on:{click:function(a){return e.handleUpdate(t.$index,t.row)}}},[e._v("Edit")]),e._v(" "),1!==t.row.id?a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-delete",round:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("Delete")]):e._e()],1)]}}])})],1),e._v(" "),a("div",{staticClass:"page",attrs:{align:"right"}},[a("el-pagination",{attrs:{"current-page":e.currentPageNum,"page-sizes":[5,10,20,40],"page-size":e.currentPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalItemCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"Add Information",visible:e.createFormVisible,showClose:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.createFormVisible=t}}},[a("el-form",{ref:"createform",attrs:{model:e.createform,size:"mini","status-icon":"",rules:e.rules}},[a("el-form-item",{staticStyle:{width:"85%"},attrs:{label:"Group Name","label-width":"120px",required:!0,prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.createform.name,callback:function(t){e.$set(e.createform,"name",t)},expression:"createform.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.createFormVisible=!1}}},[e._v("Cancel")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("OK")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"Update Information",visible:e.updateFormVisible,showClose:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.updateFormVisible=t}}},[a("el-form",{ref:"updateform",attrs:{model:e.updateform,size:"mini","status-icon":"",rules:e.rules}},[a("el-form-item",{staticStyle:{width:"85%"},attrs:{label:"Group Name","label-width":"120px",required:!0,prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.updateform.name,callback:function(t){e.$set(e.updateform,"name",t)},expression:"updateform.name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.updateFormVisible=!1}}},[e._v("Cancel")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("OK")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"Update Association Information",visible:e.relationFormVisible,showClose:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.relationFormVisible=t}}},[a("el-alert",{attrs:{title:"When unchecking items and performing update operation, unchecked items will be reassociated to the 'Default Group' with id=1.",type:"warning","show-icon":""}}),e._v(" "),a("el-tree",{ref:"relationTree",attrs:{data:e.moduleAssignments,"show-checkbox":!0,"node-key":"id","default-checked-keys":e.initCheckedKeys,"highlight-current":"",props:e.defaultProps}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.relationFormVisible=!1}}},[e._v("Close")]),e._v(" "),1!==e.currentGroupId?a("el-button",{attrs:{type:"danger"},on:{click:e.handleRelationSave}},[e._v("Update")]):e._e()],1)],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(c,u,!1,function(e){a("uyQE")},"data-v-02925144",null);t.default=m.exports},uyQE:function(e,t){}});
//# sourceMappingURL=26.d6d2d5883e3fac7140df.js.map