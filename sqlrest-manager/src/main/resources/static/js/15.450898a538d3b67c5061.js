webpackJsonp([15],{U0nr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),o=a.n(r),s={name:"datasource",data:function(){return{loading:!0,keyword:null,lists:[],currentPage:1,pageSize:10,totalCount:2,databaseType:[],connectionDriver:[],tableData:[],queryForm:{title:"",type:"",url:"",diver:"",version:"",username:"",password:""},createform:{title:"",type:"",diver:"",sample:"",url:"",version:"",username:"",password:""},updateform:{id:0,title:"",type:"",diver:"",version:"",username:"",password:""},rules:{name:[{required:!0,message:"Name cannot be empty",trigger:"blur"}],type:[{required:!0,message:"Database type must be selected",trigger:"change"}],version:[{required:!0,message:"Driver version must be selected",trigger:"change"}],url:[{required:!0,message:"JDBC URL must be provided",trigger:"blur"}]},dialogFormVisible:!1,createFormVisible:!1,updateFormVisible:!1}},methods:{formatDatabaseName:function(e){return e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():""},sortByType:function(e,t){var a=(e.type||"").toLowerCase(),r=(t.type||"").toLowerCase();return a<r?-1:a>r?1:0},loadData:function(){var e=this;this.$http({method:"POST",headers:{"Content-Type":"application/json"},url:"/sqlrest/manager/api/v1/datasource/list",data:o()({searchText:this.keyword,page:this.currentPage,size:this.pageSize})}).then(function(t){0===t.data.code?(e.currentPage=t.data.pagination.page,e.pageSize=t.data.pagination.size,e.totalCount=t.data.pagination.total,e.tableData=t.data.data):alert("Failed to load list: "+t.data.message)},function(){console.log("load connection list failed")})},searchByKeyword:function(){this.currentPage=1,this.loadData()},loadDatabaseTypes:function(){var e=this;this.databaseType=[],this.$http({method:"GET",url:"/sqlrest/manager/api/v1/datasource/types"}).then(function(t){0===t.data.code?e.databaseType=t.data.data:alert("Failed to load database types: "+t.data.message)},function(){console.log("failed")})},handleClose:function(e){},handleDelete:function(e,t){var a=this;this.$confirm("This operation will delete datasource ID="+t.id+", continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){a.$http.delete("/sqlrest/manager/api/v1/datasource/delete/"+t.id).then(function(e){0===e.data.code?a.loadData():alert("Failed to delete: "+e.data.message)})})},handleMore:function(e,t){this.dialogFormVisible=!0,this.queryForm=t},handleTest:function(e,t){var a=this;this.$http.get("/sqlrest/manager/api/v1/datasource/test/"+t.id).then(function(e){0===e.data.code?a.$alert("Connection test successful!","Success",{confirmButtonText:"OK",type:"success"}):a.$alert(e.data.message,"Error",{confirmButtonText:"OK",type:"error"})})},addConnection:function(){this.createFormVisible=!0,this.createform={}},handlePreTest:function(e,t){var a=this,r="";if(this.databaseType.length>0)for(var s=0;s<this.databaseType.length;s++)if(this.databaseType[s].type==e.type){r=this.databaseType[s].driver;break}this.$refs[t].validate(function(t){t?a.$http({method:"POST",headers:{"Content-Type":"application/json"},url:"/sqlrest/manager/api/v1/datasource/preTest",data:o()({name:e.name,type:e.type,version:e.version,driver:r,url:e.url,username:e.username,password:e.password})}).then(function(e){0===e.data.code?a.$alert("Connection test successful","Test Success",{confirmButtonText:"OK",type:"info"}):a.$alert(e.data.message,"Test Failed",{confirmButtonText:"OK",type:"error"})}):a.$alert("Please check input","Information",{confirmButtonText:"OK",type:"info"})})},handleCreate:function(){var e=this,t="";if(this.databaseType.length>0)for(var a=0;a<this.databaseType.length;a++)if(this.databaseType[a].type==this.createform.type){t=this.databaseType[a].driver;break}this.$refs.createform.validate(function(a){a?e.$http({method:"POST",headers:{"Content-Type":"application/json"},url:"/sqlrest/manager/api/v1/datasource/create",data:o()({name:e.createform.name,type:e.createform.type,version:e.createform.version,driver:t,url:e.createform.url,username:e.createform.username,password:e.createform.password})}).then(function(t){0===t.data.code?(e.createFormVisible=!1,e.$message("Connection added successfully"),e.createform={},e.loadData()):e.$alert(t.data.message,"Failed to add connection",{confirmButtonText:"OK",type:"error"})}):e.$alert("Please check input","Information",{confirmButtonText:"OK",type:"info"})})},selectChangedDriverVersion:function(e){var t=this;this.connectionDriver=[],this.$http.get("/sqlrest/manager/api/v1/datasource/"+e+"/drivers").then(function(a){if(0===a.data.code){t.connectionDriver=a.data.data;var r=t.databaseType.find(function(t){return t.type===e});r&&(t.createform.sample=r.sample)}else t.$message.error("Failed to query available driver versions: "+a.data.message),t.connectionDriver=[]})},handleUpdate:function(e,t){var a=this;this.updateform=JSON.parse(o()(t)),this.$http.get("/sqlrest/manager/api/v1/datasource/"+this.updateform.type+"/drivers").then(function(e){0===e.data.code?a.connectionDriver=e.data.data:(a.$message.error("Failed to query available driver versions: "+e.data.message),a.connectionDriver=[])}),this.updateFormVisible=!0},handleSave:function(){var e=this,t="";if(this.databaseType.length>0)for(var a=0;a<this.databaseType.length;a++)if(this.databaseType[a].type==this.updateform.type){t=this.databaseType[a].driver;break}this.$refs.updateform.validate(function(a){a?e.$http({method:"POST",headers:{"Content-Type":"application/json"},url:"/sqlrest/manager/api/v1/datasource/update",data:o()({id:e.updateform.id,name:e.updateform.name,type:e.updateform.type,version:e.updateform.version,driver:t,url:e.updateform.url,username:e.updateform.username,password:e.updateform.password})}).then(function(t){0===t.data.code?(e.updateFormVisible=!1,e.$message("Connection updated successfully"),e.loadData(),e.updateform={}):e.$alert(t.data.message,"Failed to update connection",{confirmButtonText:"OK",type:"error"})}):e.$alert("Please check input","Information",{confirmButtonText:"OK",type:"info"})})},handleSizeChange:function(e){this.loading=!0,this.pageSize=e,this.loadData()},handleCurrentChange:function(e){this.loading=!0,this.currentPage=e,this.loadData()}},created:function(){this.loadDatabaseTypes(),this.loadData()}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",{staticClass:"page-title"},[e._v("CONNECTION MANAGEMENT")]),e._v(" "),a("el-card",[a("div",{staticClass:"connection-list-top"},[a("div",{staticClass:"left-search-input-group"},[a("div",{staticClass:"left-search-input"},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"Please enter connection name keyword to search",clearable:!0},on:{change:e.searchByKeyword},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1)]),e._v(" "),a("div",{staticClass:"right-add-button-group"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addConnection}},[e._v("Add")])],1)]),e._v(" "),a("el-table",{attrs:{data:e.tableData,size:"small",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID","min-width":"5%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"Name","min-width":"15%",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"word-break":"break-word","white-space":"normal"}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"Type","min-width":"12%",sortable:"","sort-method":e.sortByType},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatDatabaseName(t.row.type)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"url",label:"URL","min-width":"35%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"word-break":"break-word","white-space":"normal"}},[e._v(e._s(t.row.url))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"Username","min-width":"12%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"word-break":"break-word","white-space":"normal"}},[e._v(e._s(t.row.username))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"Create Time","min-width":"15%",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"Action","min-width":"20%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:"Test",placement:"top",effect:"dark"}},[a("el-button",{attrs:{plain:"",size:"mini",type:"danger",circle:""},on:{click:function(a){return e.handleTest(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-video-play"})])],1),e._v(" "),a("el-tooltip",{attrs:{content:"Details",placement:"top",effect:"dark"}},[a("el-button",{attrs:{plain:"",size:"mini",type:"info",circle:""},on:{click:function(a){return e.handleMore(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-document"})])],1),e._v(" "),a("el-tooltip",{attrs:{content:"Edit",placement:"top",effect:"dark"}},[a("el-button",{attrs:{plain:"",size:"mini",type:"warning",circle:""},on:{click:function(a){return e.handleUpdate(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-edit"})])],1),e._v(" "),a("el-tooltip",{attrs:{content:"Delete",placement:"top",effect:"dark"}},[a("el-button",{attrs:{plain:"",size:"mini",type:"danger",circle:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[a("i",{staticClass:"el-icon-delete"})])],1)]}}])})],1),e._v(" "),a("div",{staticClass:"page",attrs:{align:"right"}},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,20,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"View DataSource",visible:e.dialogFormVisible,showClose:!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.queryForm,size:"mini"}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"Name","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:!0},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"Database","label-width":"100px"}},[a("el-input",{attrs:{value:e.formatDatabaseName(e.queryForm.type),"auto-complete":"off",readonly:!0}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"Database Driver","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:!0},model:{value:e.queryForm.driver,callback:function(t){e.$set(e.queryForm,"driver",t)},expression:"queryForm.driver"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"Driver Version","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:!0},model:{value:e.queryForm.version,callback:function(t){e.$set(e.queryForm,"version",t)},expression:"queryForm.version"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"JDBC URL","label-width":"100px"}},[a("el-input",{attrs:{type:"textarea",rows:6,spellcheck:!1,"auto-complete":"off",readonly:!0},model:{value:e.queryForm.url,callback:function(t){e.$set(e.queryForm,"url",t)},expression:"queryForm.url"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"Username","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",readonly:!0},model:{value:e.queryForm.username,callback:function(t){e.$set(e.queryForm,"username",t)},expression:"queryForm.username"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"Password","label-width":"100px"}},[a("el-input",{attrs:{type:"password","auto-complete":"off",readonly:!0},model:{value:e.queryForm.password,callback:function(t){e.$set(e.queryForm,"password",t)},expression:"queryForm.password"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("Close")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"New DataSource",visible:e.createFormVisible,showClose:!1,"before-close":e.handleClose,width:"700px"},on:{"update:visible":function(t){e.createFormVisible=t}}},[a("el-form",{ref:"createform",attrs:{model:e.createform,size:"small","status-icon":"",rules:e.rules}},[a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"Name","label-width":"120px",required:!0,prop:"name"}},[a("el-input",{staticClass:"form-input-large",attrs:{"auto-complete":"off"},model:{value:e.createform.name,callback:function(t){e.$set(e.createform,"name",t)},expression:"createform.name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"Database","label-width":"120px",required:!0,prop:"type"}},[a("el-select",{staticClass:"form-select-large",staticStyle:{width:"100%"},attrs:{placeholder:"Please select database"},on:{change:e.selectChangedDriverVersion},model:{value:e.createform.type,callback:function(t){e.$set(e.createform,"type",t)},expression:"createform.type"}},e._l(e.databaseType,function(t,r){return a("el-option",{key:r,attrs:{label:e.formatDatabaseName(t.type),value:t.type}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"Driver Version","label-width":"120px",required:!0,prop:"version"}},[a("el-select",{staticClass:"form-select-large",staticStyle:{width:"100%"},attrs:{placeholder:"Please select version"},model:{value:e.createform.version,callback:function(t){e.$set(e.createform,"version",t)},expression:"createform.version"}},e._l(e.connectionDriver,function(e,t){return a("el-option",{key:t,attrs:{label:e.driverVersion,value:e.driverVersion}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"JDBC URL","label-width":"120px",required:!0,prop:"url"}},[a("el-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{title:"Example:",type:"warning",description:e.createform.sample}}),e._v(" "),a("el-input",{staticClass:"form-textarea-large",attrs:{type:"textarea",rows:6,spellcheck:!1,placeholder:"Please enter","auto-complete":"off"},model:{value:e.createform.url,callback:function(t){e.$set(e.createform,"url",t)},expression:"createform.url"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"Username","label-width":"120px",prop:"username"}},[a("el-input",{staticClass:"form-input-large",attrs:{"auto-complete":"off"},model:{value:e.createform.username,callback:function(t){e.$set(e.createform,"username",t)},expression:"createform.username"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"Password","label-width":"120px",prop:"password"}},[a("el-input",{staticClass:"form-input-large",attrs:{type:"password","auto-complete":"off"},model:{value:e.createform.password,callback:function(t){e.$set(e.createform,"password",t)},expression:"createform.password"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handlePreTest(e.createform,"createform")}}},[e._v("Test")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("OK")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(t){e.createFormVisible=!1}}},[e._v("Cancel")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"Update DataSource",visible:e.updateFormVisible,showClose:!1,"before-close":e.handleClose,width:"700px"},on:{"update:visible":function(t){e.updateFormVisible=t}}},[a("el-form",{ref:"updateform",attrs:{model:e.updateform,size:"small","status-icon":"",rules:e.rules}},[a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"Name","label-width":"120px",required:!0,prop:"name"}},[a("el-input",{staticClass:"form-input-large",attrs:{"auto-complete":"off"},model:{value:e.updateform.name,callback:function(t){e.$set(e.updateform,"name",t)},expression:"updateform.name"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"Database","label-width":"120px",required:!0,prop:"type"}},[a("el-select",{staticClass:"form-select-large",staticStyle:{width:"100%"},attrs:{placeholder:"Please select database"},on:{change:e.selectChangedDriverVersion},model:{value:e.updateform.type,callback:function(t){e.$set(e.updateform,"type",t)},expression:"updateform.type"}},e._l(e.databaseType,function(t,r){return a("el-option",{key:r,attrs:{label:e.formatDatabaseName(t.type),value:t.type}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"Driver Version","label-width":"120px",required:!0,prop:"version"}},[a("el-select",{staticClass:"form-select-large",staticStyle:{width:"100%"},attrs:{placeholder:"Please select version"},model:{value:e.updateform.version,callback:function(t){e.$set(e.updateform,"version",t)},expression:"updateform.version"}},e._l(e.connectionDriver,function(e,t){return a("el-option",{key:t,attrs:{label:e.driverVersion,value:e.driverVersion}})}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"JDBC URL","label-width":"120px",required:!0,prop:"url"}},[a("el-input",{staticClass:"form-textarea-large",attrs:{type:"textarea",rows:6,spellcheck:!1,"auto-complete":"off"},model:{value:e.updateform.url,callback:function(t){e.$set(e.updateform,"url",t)},expression:"updateform.url"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"Username","label-width":"120px"}},[a("el-input",{staticClass:"form-input-large",attrs:{"auto-complete":"off"},model:{value:e.updateform.username,callback:function(t){e.$set(e.updateform,"username",t)},expression:"updateform.username"}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"520px"},attrs:{label:"Password","label-width":"120px"}},[a("el-input",{staticClass:"form-input-large",attrs:{type:"password","auto-complete":"off"},model:{value:e.updateform.password,callback:function(t){e.$set(e.updateform,"password",t)},expression:"updateform.password"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handlePreTest(e.updateform,"updateform")}}},[e._v("Test")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("OK")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(t){e.updateFormVisible=!1}}},[e._v("Cancel")])],1)],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,l,!1,function(e){a("efwL")},"data-v-84ed3034",null);t.default=i.exports},efwL:function(e,t){}});
//# sourceMappingURL=15.450898a538d3b67c5061.js.map