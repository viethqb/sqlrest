webpackJsonp([22],{NcaZ:function(t,e){},tq0o:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("mvHQ"),s=a.n(n),l={name:"alarm",data:function(){return{status:"ON",endpoint:"",contentType:"application/json",inputTemplate:"",testFormVisible:!1,dataModel:{}}},methods:{loadData:function(){var t=this;this.$http.get("/sqlrest/manager/api/v1/alarm/detail").then(function(e){0===e.data.code?(t.status=e.data.data.status,t.endpoint=e.data.data.endpoint,t.contentType=e.data.data.contentType,t.inputTemplate=e.data.data.inputTemplate):alert("Failed to load data: "+e.data.message)})},handleShowTest:function(){var t=this;this.$http.get("/sqlrest/manager/api/v1/alarm/example").then(function(e){0===e.data.code?(t.dataModel=e.data.data,t.testFormVisible=!0):alert("Failed to load data: "+e.data.message)})},handleClose:function(t){},handleSendTest:function(){var t=this;"ON"!==this.status||this.endpoint&&!/^\s*$/.test(this.endpoint)?"ON"!==this.status||this.contentType&&!/^\s*$/.test(this.contentType)?"ON"!==this.status||this.inputTemplate&&!/^\s*$/.test(this.inputTemplate)?this.$http({method:"POST",headers:{"Content-Type":"application/json"},url:"/sqlrest/manager/api/v1/alarm/test",data:s()({endpoint:this.endpoint,contentType:this.contentType,inputTemplate:this.inputTemplate,dataModel:this.dataModel})}).then(function(e){0===e.data.code?t.$alert("Test sent successfully, please check the alarm log in the alarm system","Information",{confirmButtonText:"OK",type:"info"}):t.$alert(e.data.message,"Information",{confirmButtonText:"OK",type:"error"})}):alert("Input template must be provided!"):alert("Input type must be selected!"):alert("API endpoint cannot be empty!")},handleSave:function(){var t=this;"ON"!==this.status||this.endpoint&&!/^\s*$/.test(this.endpoint)?"ON"!==this.status||this.contentType&&!/^\s*$/.test(this.contentType)?"ON"!==this.status||this.inputTemplate&&!/^\s*$/.test(this.inputTemplate)?this.$http({method:"POST",headers:{"Content-Type":"application/json"},url:"/sqlrest/manager/api/v1/alarm/save",data:s()({status:this.status,endpoint:this.endpoint,contentType:this.contentType,inputTemplate:this.inputTemplate})}).then(function(e){0===e.data.code?(t.$alert("Alarm configuration saved successfully","Information",{confirmButtonText:"OK",type:"info"}),t.loadData()):alert("Failed to save: "+e.data.message)}):alert("Input template must be provided!"):alert("Input type must be selected!"):alert("API endpoint cannot be empty!")}},created:function(){this.loadData()}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",{staticClass:"page-title"},[t._v("ALARM CONFIG")]),t._v(" "),a("el-card",[a("el-form",{attrs:{"label-width":"200px"}},[a("el-form-item",{attrs:{label:"Alarm Configuration"}},[a("el-switch",{attrs:{"active-color":"#13ce66","active-value":"ON","inactive-value":"OFF","active-text":"On","inactive-text":"Off"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"ON"==t.status,expression:"status=='ON'"}]},[a("el-form-item",{attrs:{label:"API Endpoint"}},[a("span",{staticStyle:{display:"inline-block"},attrs:{slot:"label"},slot:"label"},[t._v("\n            API Endpoint\n            "),a("el-tooltip",{attrs:{effect:"dark",content:"Please refer to the message sending API provided by the corresponding alarm system",placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])],1),t._v(" "),a("el-input",{attrs:{placeholder:"Please enter API path, e.g.: http://127.0.0.1:8000/api/v1/message/send"},model:{value:t.endpoint,callback:function(e){t.endpoint=e},expression:"endpoint"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Input Format"}},[a("span",{staticStyle:{display:"inline-block"},attrs:{slot:"label"},slot:"label"},[t._v("\n            Input Format\n            "),a("el-tooltip",{attrs:{effect:"dark",content:"Input data format, currently only supports Content-Type as application/json",placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])],1),t._v(" "),a("el-select",{model:{value:t.contentType,callback:function(e){t.contentType=e},expression:"contentType"}},[a("el-option",{attrs:{label:"application/json",value:"application/json"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"Input Template"}},[a("span",{staticStyle:{display:"inline-block"},attrs:{slot:"label"},slot:"label"},[t._v("\n            Input Template\n            "),a("el-tooltip",{attrs:{effect:"dark",content:"Please refer to the corresponding alarm system for input data format; click 'Test' button to view all supported variable parameters in the template.",placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])],1),t._v(" "),a("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:20},placeholder:"Please enter input content template, use ${xxx} as placeholder for variable parts."},model:{value:t.inputTemplate,callback:function(e){t.inputTemplate=e},expression:"inputTemplate"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"ON"==t.status,expression:"status=='ON'"}],attrs:{type:"primary",plain:""},on:{click:t.handleShowTest}},[t._v("Test")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.handleSave}},[t._v("Save")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"Test Alarm Configuration",visible:t.testFormVisible,showClose:!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.testFormVisible=e}}},[a("el-form",{attrs:{"label-width":"200px"}},t._l(t.dataModel,function(e){return a("el-form-item",t._b({key:e.key,attrs:{label:"${"+e.key+"}"}},"el-form-item",e,!1),[a("el-input",{key:e.key,attrs:{type:"text",value:e.value},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)}),1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.handleSendTest}},[t._v("Test")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.testFormVisible=!1}}},[t._v("Close")])],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(l,i,!1,function(t){a("NcaZ")},"data-v-399586bd",null);e.default=o.exports}});
//# sourceMappingURL=22.50d4ff8b7ef1032e6154.js.map