webpackJsonp([23],{GbmM:function(t,e){},tq0o:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("mvHQ"),s=a.n(n),l={name:"alarm",data:function(){return{status:"ON",endpoint:"",contentType:"application/json",inputTemplate:"",testFormVisible:!1,dataModel:{}}},methods:{loadData:function(){var t=this;this.$http.get("/sqlrest/manager/api/v1/alarm/detail").then(function(e){0===e.data.code?(t.status=e.data.data.status,t.endpoint=e.data.data.endpoint,t.contentType=e.data.data.contentType,t.inputTemplate=e.data.data.inputTemplate):alert("加载数据失败:"+e.data.message)})},handleShowTest:function(){var t=this;this.$http.get("/sqlrest/manager/api/v1/alarm/example").then(function(e){0===e.data.code?(t.dataModel=e.data.data,t.testFormVisible=!0):alert("加载数据失败:"+e.data.message)})},handleClose:function(t){},handleSendTest:function(){var t=this;"ON"!==this.status||this.endpoint&&!/^\s*$/.test(this.endpoint)?"ON"!==this.status||this.contentType&&!/^\s*$/.test(this.contentType)?"ON"!==this.status||this.inputTemplate&&!/^\s*$/.test(this.inputTemplate)?this.$http({method:"POST",headers:{"Content-Type":"application/json"},url:"/sqlrest/manager/api/v1/alarm/test",data:s()({endpoint:this.endpoint,contentType:this.contentType,inputTemplate:this.inputTemplate,dataModel:this.dataModel})}).then(function(e){0===e.data.code?t.$alert("发送测试成功，请去告警系统查看发送的告警日志信息","提示信息",{confirmButtonText:"确定",type:"info"}):t.$alert(e.data.message,"提示信息",{confirmButtonText:"确定",type:"error"})}):alert("入参模板必须输入!"):alert("入参类型必须选择!"):alert("接口端点不能为空!")},handleSave:function(){var t=this;"ON"!==this.status||this.endpoint&&!/^\s*$/.test(this.endpoint)?"ON"!==this.status||this.contentType&&!/^\s*$/.test(this.contentType)?"ON"!==this.status||this.inputTemplate&&!/^\s*$/.test(this.inputTemplate)?this.$http({method:"POST",headers:{"Content-Type":"application/json"},url:"/sqlrest/manager/api/v1/alarm/save",data:s()({status:this.status,endpoint:this.endpoint,contentType:this.contentType,inputTemplate:this.inputTemplate})}).then(function(e){0===e.data.code?(t.$alert("告警配置保存成功","提示信息",{confirmButtonText:"确定",type:"info"}),t.loadData()):alert("保存失败:"+e.data.message)}):alert("入参模板必须输入!"):alert("入参类型必须选择!"):alert("接口端点不能为空!")}},created:function(){this.loadData()}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",[a("el-form",{attrs:{"label-width":"200px"}},[a("el-form-item",{attrs:{label:"告警配置"}},[a("el-switch",{attrs:{"active-color":"#13ce66","active-value":"ON","inactive-value":"OFF","active-text":"开启","inactive-text":"关闭"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"ON"==t.status,expression:"status=='ON'"}]},[a("el-form-item",{attrs:{label:"接口端点"}},[a("span",{staticStyle:{display:"inline-block"},attrs:{slot:"label"},slot:"label"},[t._v("\n            接口端点\n            "),a("el-tooltip",{attrs:{effect:"dark",content:"接口端点请查阅对应的告警系统所提供的消息发送接口",placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])],1),t._v(" "),a("el-input",{attrs:{placeholder:"请输入接口的路径，例如：http://127.0.0.1:8000/api/v1/message/send"},model:{value:t.endpoint,callback:function(e){t.endpoint=e},expression:"endpoint"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"入参格式"}},[a("span",{staticStyle:{display:"inline-block"},attrs:{slot:"label"},slot:"label"},[t._v("\n            入参格式\n            "),a("el-tooltip",{attrs:{effect:"dark",content:"接口的入参数据格式，目前只支持Content-Type为application/json",placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])],1),t._v(" "),a("el-select",{model:{value:t.contentType,callback:function(e){t.contentType=e},expression:"contentType"}},[a("el-option",{attrs:{label:"application/json",value:"application/json"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"入参模板"}},[a("span",{staticStyle:{display:"inline-block"},attrs:{slot:"label"},slot:"label"},[t._v("\n            入参模板\n            "),a("el-tooltip",{attrs:{effect:"dark",content:"入参数据格式请查阅对应的告警系统；模板支持的所有变量参数请点击“测试”按钮查看。",placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])],1),t._v(" "),a("el-input",{attrs:{type:"textarea",autosize:{minRows:8,maxRows:20},placeholder:"请输入接口的入参内容模板，变参部分请以${xxx}占位."},model:{value:t.inputTemplate,callback:function(e){t.inputTemplate=e},expression:"inputTemplate"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"ON"==t.status,expression:"status=='ON'"}],attrs:{type:"primary",plain:""},on:{click:t.handleShowTest}},[t._v("测试")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.handleSave}},[t._v("保存")])],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"测试告警配置",visible:t.testFormVisible,showClose:!1,"before-close":t.handleClose},on:{"update:visible":function(e){t.testFormVisible=e}}},[a("el-form",{attrs:{"label-width":"200px"}},t._l(t.dataModel,function(e){return a("el-form-item",t._b({key:e.key,attrs:{label:"${"+e.key+"}"}},"el-form-item",e,!1),[a("el-input",{key:e.key,attrs:{type:"text",value:e.value},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)}),1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.handleSendTest}},[t._v("测试")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.testFormVisible=!1}}},[t._v("关 闭")])],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(l,i,!1,function(t){a("GbmM")},"data-v-18b0eef3",null);e.default=o.exports}});
//# sourceMappingURL=23.daf64a089b1a299db53d.js.map