<?xml version="1.0" encoding="UTF-8"?>
<configuration scan="true" scanPeriod=" 5 seconds">

  <!-- Define log file storage address. Do not use relative paths in LogBack configuration -->
  <property name="LOG_HOME" value="./logs" />

  <!-- Console output -->
  <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
      <!-- Formatted output: %d=date, %thread=thread name, %-5level=level displayed from left with 5 char width, %msg=log message, %n=newline -->
      <pattern>[%d{yyyy-MM-dd HH:mm:ss.SSS}] [%-5level] [%thread] [%logger{50}] - %msg%n</pattern>
    </encoder>
  </appender>

  <!-- Generate log file daily -->
  <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
    <File>${LOG_HOME}/executor_server.log</File>
    <filter class="ch.qos.logback.classic.filter.LevelFilter">
      <onMatch>DENY</onMatch>
      <onMismatch>ACCEPT</onMismatch>
    </filter>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
      <!-- Log file output filename -->
      <FileNamePattern>${LOG_HOME}/executor_server_%d{yyyy-MM-dd}.log.%i.gz</FileNamePattern>
      <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
        <!-- or whenever the file size reaches 100MB -->
        <maxFileSize>512MB</maxFileSize>
      </timeBasedFileNamingAndTriggeringPolicy>
      <!-- Log file retention days -->
      <MaxHistory>30</MaxHistory>
    </rollingPolicy>
    <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
      <!-- Formatted output: %d=date, %thread=thread name, %-5level=level displayed from left with 5 char width, %msg=log message, %n=newline -->
      <pattern>[%d{yyyy-MM-dd HH:mm:ss.SSS}] [%-5level] [%thread] [%logger{50}] - %msg%n</pattern>
    </encoder>
  </appender>

  <!-- Log output level -->
  <root level="INFO">
    <appender-ref ref="STDOUT" />
  </root>

</configuration>
